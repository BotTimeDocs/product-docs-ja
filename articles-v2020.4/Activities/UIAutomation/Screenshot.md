# スクリーンショット

スクリーンショットを実現し、結果を指定の位置や変数に保存します。

## プロパティ

### 基本

- **表示名** ：デフォルトはこのアクティビティの名前です。このアクティビティの表示名の変更、カスタマイズがサポートされています。
- **エラー発生時に実行を継続** ：このアクティビティが実行失敗した場合、エラーを無視して次のアクティビティを実行するかどうかを設定します。プルダウンフレーム選択に"はい"を選択すると、このアクティビティが実行中にエラーが発生した場合、プロセスは次のアクティビティを実行し続け、停止しません。"いいえ"を選択した場合、このアクティビティが実行中にエラーが発生した場合、プロセスは実行を停止し、エラーをスローします。
- **実行前の待機時間(ミリ秒)** ：このアクティビティの実行前の待ち時間を指定します。単位はミリ秒（ms）で、1000ms = 1sです。ここに1000を記入すると、前のアクティビティの実行が完了したら、一秒後にこのアクティビティを実行するという意味です。
- **実行後の待機時間(ミリ秒)** ：このアクティビティの実行後の待ち時間を指定します。単位はミリ秒（ms）で、1000ms = 1sです。ここに1000を記入すると、このアクティビティの実行が完了したら、一秒後に次のアクティビティを実行するという意味です。
- **タイムアウト(ミリ秒)** ：このアクティビティの実行時間を指定します。単位はミリ秒（ms）で、1000ms = 1sです。マッチングタイムアウト(ミリ秒)が含まれます。この時間を超えたら、アクティビティがまだ実行されていない場合、エラーがスローされます。

ターゲット
- **コントロール要素** ：変数を受信してクリックのターゲット要素とします。この項は**セレクタ**と二者択一で入力する必要があります。
- **[セレクタ](../Appendix/Selector.md?_v=v2020.4)** ：クリックする目標位置を示すために使用します。**要素を指定**をクリックすることで自動生成できます。文字列変数と文字列のみをサポートします。
- **検出タイムアウト（ミリ秒）** ：ターゲット要素を検索する時間を限定し、指定時間を超えたら待ちません。この時間を超えて指定された要素が検出されていない場合、エラーがスローされます。単位はミリ秒（ms）で、1000ms = 1sです。整数変数と整数型のみサポートされています。

保存
- **パス** ：スクリーンショットの保存位置。この項目を空にすることはできます。記入しない場合は、デフォルトでスクリーンショットを保存しません。相対パスと絶対パスをサポートします。パスはファイル名と拡張子を指定しなければなりません。サポートのサフィックスはPNG、BMP、JPEG、JPGです。例えば：E:\Screenshot.jpg。文字列変数と文字列のみをサポートします。
- **上書きする** ：上記の**パス**にスクリーンショットを保存し、同じ名前のファイルがある場合、この項目をチェックするとエラーが表示されなく、上書きします。この項目をチェックしない場合、実行失敗が表示されます。

### 出力
- **画像** ：スクリーンショットをこの変数に保存します。この項目を空にすることはできます。

### オプション
- **画像の高さ** ：スクリーンショットで得られた画像の長さ。この項目を空にすることはできます。整数変数と整数型のみサポートされています。
- **画像の幅** ：スクリーンショットで得られた画像の幅。この項目を空にすることはできます。整数変数と整数型のみサポートされています。
- **Xオフセット** ：指定された要素から得られた画像位置に応じて、水平方向のピクセル量をオフセットします。例えば"10"を入力すると、右に10ピクセルオフセットします。座標を計算する時は、画面左上の角を原点とします。整数変数と整数型のみサポートされています。
- **Yオフセット** ：指定された要素から得られた画像位置に応じて、垂直方向のピクセル量をオフセットします。例えば"10"を記入すると、下に10ピクセルオフセットします。座標を計算する時は、画面左上の角を原点とします。整数変数と整数型のみサポートされています。
- **Χレート** ：指定された要素から得られた画像の位置をパーセンテージで移動します。指定された要素から得られた画像の長さを基数とし、掛けるこのプロパティ値、その結果が元の画像のΧ座標と加算し、最終のクリックΧ座標を取得します。
例えば"0.5"を入力し、最終のスクリーンショット位置の計算過程は：指定した要素の矩形枠の長さを取って、掛ける0.5、その結果が長方形枠の長さの半分となります。指定した要素の矩形枠の長さと加算し、最終的に得られた数字はスクリーンショット開始のΧ座標、すなわち矩形枠の中心になります。
- **Yレート** ：指定された要素から得られた画像の位置をパーセンテージで移動します。指定された要素から得られた画像の幅を基数とし、掛けるこのプロパティ値、その結果が元の画像のY座標と加算し、最終のクリックY座標を取得します。
例えば"0.5"を入力し、最終のスクリーンショット位置の計算過程は：指定した要素の矩形枠の幅を取って、掛ける0.5、その結果が長方形枠の幅の半分となります。指定した要素の矩形枠の幅と加算し、最終的に得られた数字はスクリーンショット開始のY座標、すなわち矩形枠の中心になります。



<table><td bgcolor=	#F0F8FF>上記のオプションのプロパティは空白のままにすることができ、スクリーンショットにオフセットが必要な場合にのみ入力する必要があります。 さらに、オフセットを計算するとき、指定された要素が計算の基準として使用されます。</td></table>
